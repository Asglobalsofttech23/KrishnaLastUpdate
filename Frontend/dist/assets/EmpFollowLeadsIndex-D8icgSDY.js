import{af as te,r as s,c as se,d as le,j as e,G as o,B as ne,g as m,a9 as b,F as ie,ac as oe,aa as i,a1 as re,a2 as ce,a3 as de,a4 as he,a5 as E,a6 as l,a7 as ue,ag as xe,S as je,Z as me,a0 as pe,a8 as fe}from"./index-BHisX-em.js";import{h as _}from"./moment-G82_0lEo.js";import{T as ge,a as A,U as Ce}from"./UpdateFlwLeads-D-434VQN.js";import{P as Se}from"./Pagination-QMDpzdN5.js";import"./FormControlLabel-xFWTLzzh.js";const Pe=()=>{const M=te(),[d,I]=s.useState([]),[D,y]=s.useState(null),[p,P]=s.useState(null),[f,g]=s.useState([]),[h,w]=s.useState(5),[C,S]=s.useState(1),[N,O]=s.useState([]),[W,L]=s.useState([]),[r,T]=s.useState(""),[u,F]=s.useState(""),[c,k]=s.useState("");sessionStorage.getItem("emp_id");const[x,B]=s.useState(1),[U,j]=s.useState(!1),[z,Q]=s.useState([]);s.useState(!1),s.useState([]),s.useState(!1),s.useState([]),s.useEffect(()=>{se.get(`${le.apiUrl}/leads/empFollowLeadsForAdmin`).then(a=>{const t=new Set(a.data.map(n=>n.leads_state));O([...t]),I(a.data),g(a.data)}).catch(a=>{console.log("Leads data is not fetched.",a)})},[U]),s.useEffect(()=>{if(r){const a=new Set(d.filter(t=>t.leads_state===r).map(t=>t.leads_city));L([...a])}else L([])},[r]),s.useEffect(()=>{const a=_().format("YYYY-MM-DD"),t=d.filter(n=>{const K=c===""||n.leads_name.toLowerCase().includes(c.toLowerCase())||n.leads_name.toUpperCase().includes(c.toUpperCase)||n.leads_email.toLowerCase().includes(c.toLowerCase())||n.leads_email.toUpperCase().includes(c.toUpperCase())||n.leads_mobile.includes(c),X=r===""||n.leads_state===r,ee=u===""||n.leads_city===u,ae=x===1||x===2&&_(n.created_at).format("YYYY-MM-DD")===a;return K&&X&&ee&&ae});g(t)},[c,r,u,x,d]);const R=a=>{const t=parseInt(a.target.value,10);t==1?(w(d.length),S(1)):(w(t),S(1))},$=(C-1)*h,G=C*h,V=f?f.slice($,G):[],q=()=>{T(""),F(""),k(""),g(d)},H=a=>{const t=d.find(n=>n.follow_id===a);t&&(Q(t),j(!0))},Z=(a,t)=>{y(a.currentTarget),P(t)},Y=()=>{y(null),P(null)},v=(a,t)=>{Y(),M(`/${a}/${t}`)},J=!!D;return e.jsxs("div",{style:{padding:"10px"},children:[e.jsx("h1",{className:"text-center",children:"Followed Leads Index"}),e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:8,children:e.jsx(ne,{sx:{width:"100%",bgcolor:"background.paper"},children:e.jsxs(ge,{value:x,onChange:(a,t)=>B(t),centered:!0,children:[e.jsx(A,{label:"All Leads",value:1}),e.jsx(A,{label:"Today's Leads",value:2})]})})}),e.jsx(o,{item:!0,xs:4,display:"flex",justifyContent:"end",children:e.jsx(m,{variant:"outlined",onClick:q,children:"Cancel Filters"})})]}),e.jsxs(o,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(o,{item:!0,xs:6,children:e.jsx(b,{fullWidth:!0,label:"Search",placeholder:"Search by name, email, or mobile",onChange:a=>k(a.target.value),value:c})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(ie,{fullWidth:!0,children:e.jsxs(oe,{value:h,onChange:R,children:[e.jsx(i,{value:5,children:"5 Per Page"}),e.jsx(i,{value:10,children:"10 Per Page"}),e.jsx(i,{value:15,children:"15 Per Page"}),e.jsx(i,{value:1,children:"All Per Page"})]})})})]}),e.jsxs(o,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(o,{item:!0,xs:6,children:e.jsxs(b,{fullWidth:!0,select:!0,label:"Select State",value:r,onChange:a=>T(a.target.value),children:[e.jsx(i,{value:"",children:"All States"}),N.map((a,t)=>e.jsx(i,{value:a,children:a},t))]})}),e.jsx(o,{item:!0,xs:6,children:e.jsxs(b,{fullWidth:!0,select:!0,label:"Select City",value:u,onChange:a=>F(a.target.value),disabled:!r,children:[e.jsx(i,{value:"",children:"All Cities"}),W.map((a,t)=>e.jsx(i,{value:a,children:a},t))]})})]}),e.jsx(re,{component:ce,style:{marginTop:"20px"},children:e.jsxs(de,{children:[e.jsx(he,{children:e.jsxs(E,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:[e.jsx(l,{children:"S.No"}),e.jsx(l,{children:"Employee Name"}),e.jsx(l,{children:"Leads Name"}),e.jsx(l,{children:"Leads Mobile"}),e.jsx(l,{children:"Leads Email"}),e.jsx(l,{children:"Leads Company"}),e.jsx(l,{children:"State"}),e.jsx(l,{children:"City"}),e.jsx(l,{children:"Reminder Date"}),e.jsx(l,{children:"Action"})]})}),e.jsx(ue,{children:V.map((a,t)=>e.jsxs(E,{children:[e.jsx(l,{children:t+1}),e.jsx(l,{children:a.emp_name}),e.jsx(l,{children:a.leads_name}),e.jsx(l,{children:a.leads_mobile}),e.jsx(l,{children:a.leads_email}),e.jsx(l,{children:a.leads_company}),e.jsx(l,{children:a.leads_state}),e.jsx(l,{children:a.leads_city}),e.jsx(l,{children:_(a.reminder_date).format("YYYY-MM-DD")}),e.jsxs(l,{children:[e.jsx(m,{variant:"outlined",onClick:n=>Z(n,a),children:"Quotation"}),e.jsxs(xe,{open:J&&(p==null?void 0:p.follow_id)===a.follow_id,anchorEl:D,onClose:Y,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[e.jsx(i,{onClick:()=>v("quotation",a.follow_id),children:"Quotation"}),e.jsx(i,{onClick:()=>v("proforma",a.follow_id),children:"Proforma"}),e.jsx(i,{onClick:()=>v("invoice",a.follow_id),children:"Invoice"})]}),e.jsx(m,{onClick:()=>H(a.follow_id),children:"Edit"})]})]},t))})]})}),e.jsx(o,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(je,{spacing:2,children:e.jsx(Se,{count:Math.ceil(f.length/h),page:C,onChange:(a,t)=>S(t),size:"small"})})}),e.jsxs(me,{open:U,onClose:()=>j(!1),maxWidth:"md",children:[e.jsx(pe,{children:e.jsx(Ce,{data:z,onClose:()=>j(!1)})}),e.jsx(fe,{children:e.jsx(m,{onClick:()=>j(!1),children:"Close"})})]})]})};export{Pe as default};
