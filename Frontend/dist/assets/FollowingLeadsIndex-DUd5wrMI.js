import{r as t,j as e,G as s,a9 as l,aa as f,g as w,c as q,d as z,ab as le,ae as ne,af as Pe,B as Te,F as Me,ac as Ne,a1 as Ee,a2 as Fe,a3 as Oe,a4 as Ye,a5 as ee,a6 as m,a7 as Ae,ag as Ue,S as Ie,Z as U,a0 as I,a8 as R,$ as Re}from"./index-BHisX-em.js";import{h as Q}from"./moment-G82_0lEo.js";import{T as Be,a as se,U as $e}from"./UpdateFlwLeads-D-434VQN.js";import{C as Ve}from"./ConvertCustomer-jA0DSWXZ.js";import{F as ae,C as te}from"./FormControlLabel-xFWTLzzh.js";import{P as Qe}from"./Pagination-QMDpzdN5.js";const qe=({onClose:F,data:n})=>{const[u,r]=t.useState({leads_name:n?n.leads_name:"",leads_mobile:n?n.leads_mobile:"",leads_email:n?n.leads_email:"",leads_company:n?n.leads_company:"",leads_address:n?n.leads_address:"",leads_state:n?n.leads_state:"",leads_city:n?n.leads_city:"",product_name:n?n.product_name:"",Call_Discussion:n?n.Call_Discussion:"",remember:n?n.remember:"",reminder_date:n?n.reminder_date:""}),[p,k]=t.useState({Call_Discussion:"",remember:"",reminder_date:""}),W=(S,x)=>{let h="";const g=x&&typeof x=="string"?x.trim():x;switch(S){case"Call_Discussion":g||(h="Leads Query Message is Required");break;case"remember":g?g==="yes"&&!u.reminder_date&&(h="Reminder Date is Required"):h="Please Select one";break}return h},d=S=>{const{name:x,value:h}=S.target,g=W(x,h);r({...u,[x]:h}),k({...p,[x]:g})},P=S=>{S.preventDefault();let x={};Object.keys(u).forEach(h=>{const g=u[h],M=W(h,g);M&&(x[h]=M)}),Object.keys(x).length>0&&k(x),q.put(`${z.apiUrl}/leads/updateFlwLeadForEmp/${n.follow_id}`,u).then(h=>{console.log("Data Added Successfully.",h),F()}).catch(h=>{console.log("Data is not added",h)})};return e.jsx("div",{children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"leads_name",label:"Lead Name",value:u.leads_name,onChange:d})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"leads_mobile",label:"Lead Mobile",value:u.leads_mobile,onChange:d})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"leads_email",label:"Lead Email",value:u.leads_email,onChange:d})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"leads_company",label:"Lead Company",value:u.leads_company,onChange:d})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"leads_address",label:"Lead Address",value:u.leads_address,onChange:d})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"leads_state",label:"Lead State",value:u.leads_state,onChange:d})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"leads_city",label:"Lead City",value:u.leads_city,onChange:d})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"product_name",label:"Product Name",value:u.product_name,onChange:d})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"Call_Discussion",label:"Leads Query",value:u.Call_Discussion,onChange:d,error:!!p.Call_Discussion,helperText:p.Call_Discussion})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(l,{fullWidth:!0,select:!0,name:"remember",label:"Remember",value:u.remember,onChange:d,error:!!p.remember,helperText:p.remember,children:[e.jsx(f,{value:"Yes",children:"Yes"}),e.jsx(f,{value:"No",children:"No"})]})}),u.remember==="Yes"&&e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"reminder_date",label:"Reminder Date",type:"date",value:u.reminder_date,onChange:d,error:!!p.reminder_date,helperText:p.reminder_date,InputLabelProps:{shrink:!0}})}),e.jsx(s,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(w,{onClick:P,children:"Submit"})})]})})},ze=({onClose:F,onSuccess:n})=>{const u=sessionStorage.getItem("emp_id"),[r,p]=t.useState({emp_id:u,leads_name:"",leads_mobile:"",leads_email:"",leads_company:"",leads_address:"",leads_city:"",leads_state:"",Call_Discussion:"",remember:"No",reminder_date:"",gst_number:"",billing_address:{door_number:"",street:"",landMark:"",city:"",state:"",pincode:""},shipping_address:{door_number:"",street:"",landMark:"",city:"",state:"",pincode:""}}),[k,W]=t.useState({Call_Discussion:"",remember:"",reminder_date:""}),[d,P]=t.useState(!1),[S,x]=t.useState(!1),[h,g]=t.useState(""),[M,O]=t.useState("success"),Y=(_,o)=>{let j="";const C=o&&typeof o=="string"?o.trim():o;switch(_){case"Call_Discussion":C||(j="Leads Query Message is Required");break;case"remember":C?C==="Yes"&&!r.reminder_date&&(j="Reminder Date is Required"):j="Please Select one";break}return j},c=_=>{const{name:o,value:j}=_.target,C=j.toLowerCase().replace(/\b\w/g,y=>y.toUpperCase());if(o.startsWith("billing_address")||o.startsWith("shipping_address")){const[y,T]=o.split(".");p(v=>({...v,[y]:{...v[y],[T]:C||""},...y==="billing_address"&&{leads_city:T==="city"?C:v.leads_city,leads_state:T==="state"?C:v.leads_state}})),d&&y==="billing_address"&&p(v=>({...v,shipping_address:{...v.shipping_address,[T]:C||""}}))}else p(y=>({...y,[o]:C||""}));const L=Y(o,j);W(y=>({...y,[o]:L}))},D=()=>{P(!d),d||p(_=>({..._,shipping_address:{..._.billing_address}}))},E=(_,o)=>{o!=="clickaway"&&x(!1)},N=_=>{_.preventDefault();let o={};Object.keys(r).forEach(j=>{const C=r[j],L=Y(j,C);L&&(o[j]=L)}),Object.keys(o).length>0?W(o):q.post(`${z.apiUrl}/leads/waking-leads/create`,r).then(j=>{console.log("New Lead Created Successfully.",j),g("New Lead created successfully."),O("success"),x(!0),n()}).catch(j=>{console.log("Lead creation failed",j),g("New Lead created failed."),O("error"),x(!0)})};return e.jsxs("div",{children:[e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"leads_name",label:"Lead Name",value:r.leads_name||"",onChange:c})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"leads_mobile",label:"Lead Mobile",value:r.leads_mobile||"",onChange:c})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"leads_email",label:"Lead Email",value:r.leads_email||"",onChange:c})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"leads_company",label:"Lead Company",value:r.leads_company||"",onChange:c})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"gst_number",label:"GST Number",value:r.gst_number||"",onChange:c})}),e.jsx(s,{item:!0,xs:12,children:e.jsx("h3",{children:"Billing Address"})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"billing_address.door_number",label:"Door Number",value:r.billing_address.door_number||"",onChange:c})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"billing_address.street",label:"Street",value:r.billing_address.street||"",onChange:c})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"billing_address.landMark",label:"Land Mark",value:r.billing_address.landMark||"",onChange:c})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"billing_address.city",label:"City",value:r.billing_address.city||"",onChange:c})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"billing_address.state",label:"State",value:r.billing_address.state||"",onChange:c})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"billing_address.pincode",label:"Pincode",value:r.billing_address.pincode||"",onChange:c})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(ae,{control:e.jsx(te,{checked:d,onChange:D}),label:"Same as Billing Address"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx("h3",{children:"Shipping Address"})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"shipping_address.door_number",label:"Door Number",value:r.shipping_address.door_number||"",onChange:c,disabled:d})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"shipping_address.street",label:"Street",value:r.shipping_address.street||"",onChange:c,disabled:d})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"shipping_address.landMark",label:"Land Mark",value:r.shipping_address.landMark||"",onChange:c,disabled:d})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"shipping_address.city",label:"City",value:r.shipping_address.city||"",onChange:c,disabled:d})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"shipping_address.state",label:"State",value:r.shipping_address.state||"",onChange:c,disabled:d})}),e.jsx(s,{item:!0,xs:4,children:e.jsx(l,{fullWidth:!0,name:"shipping_address.pincode",label:"Pincode",value:r.shipping_address.pincode||"",onChange:c,disabled:d})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(ae,{control:e.jsx(te,{checked:r.remember==="Yes",onChange:()=>p(_=>({..._,remember:r.remember==="Yes"?"No":"Yes"}))}),label:"Remember"})}),r.remember==="Yes"&&e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,name:"reminder_date",label:"Reminder Date",type:"date",value:r.reminder_date,onChange:c,error:!!k.reminder_date,helperText:k.reminder_date,InputLabelProps:{shrink:!0}})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(l,{fullWidth:!0,name:"Call_Discussion",label:"Call Discussion",multiline:!0,rows:4,value:r.Call_Discussion||"",onChange:c,error:!!k.Call_Discussion,helperText:k.Call_Discussion})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(w,{variant:"contained",color:"primary",onClick:N,children:"Submit"})})]}),e.jsx(le,{open:S,autoHideDuration:4e3,onClose:E,anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(ne,{onClose:E,severity:M,sx:{width:"100%"},children:h})})]})},ts=()=>{const F=Pe(),[n,u]=t.useState([]),[r,p]=t.useState(null),[k,W]=t.useState(null),[d,P]=t.useState([]),[S,x]=t.useState(5),[h,g]=t.useState(1),[M,O]=t.useState([]),[Y,c]=t.useState([]),[D,E]=t.useState(""),[N,_]=t.useState(""),[o,j]=t.useState(""),C=sessionStorage.getItem("emp_id"),[L,y]=t.useState(1),[T,v]=t.useState(!1),[G,A]=t.useState(!1),[H,Ge]=t.useState([]),[re,Z]=t.useState([]),[ie,B]=t.useState(!1),[de,He]=t.useState([]),[oe,$]=t.useState(!1),[ce,Ze]=t.useState([]),[ue,J]=t.useState(!1),[he,me]=t.useState(""),[xe,je]=t.useState("success");t.useEffect(()=>{q.get(`${z.apiUrl}/leads/followingLeadsByEmpId?emp_id=${C}`).then(a=>{const i=new Set(a.data.map(b=>b.leads_state));O([...i]),u(a.data),P(a.data)}).catch(a=>{console.log("Leads data is not fetched.",a)})},[T,H,G]),t.useEffect(()=>{if(D){const a=new Set(n.filter(i=>i.leads_state===D).map(i=>i.leads_city));c([...a])}else c([])},[D]),t.useEffect(()=>{const a=Q().format("YYYY-MM-DD"),i=n.filter(b=>{const De=o===""||b.leads_name.toLowerCase().includes(o.toLowerCase())||b.leads_name.toUpperCase().includes(o.toUpperCase)||b.leads_email.toLowerCase().includes(o.toLowerCase())||b.leads_email.toUpperCase().includes(o.toUpperCase())||b.leads_mobile.includes(o),we=D===""||b.leads_state===D,Le=N===""||b.leads_city===N,We=L===1||L===2&&Q(b.created_at).format("YYYY-MM-DD")===a;return De&&we&&Le&&We});P(i)},[o,D,N,L,n]);const pe=a=>{const i=parseInt(a.target.value,10);i==1?(x(n.length),g(1)):(x(i),g(1))},ge=(h-1)*S,_e=h*S,be=d?d.slice(ge,_e):[],Ce=()=>{E(""),_(""),j(""),P(n)},fe=a=>{const i=n.find(b=>b.follow_id===a);i&&(Z(i),v(!0))},Se=a=>{Z(""),A(!0)},ye=(a,i)=>{p(a.currentTarget),W(i)},K=()=>{p(null),W(null)},V=(a,i)=>{K(),F(`/${a}/${i}`)},ve=!!r,X=()=>{J(!1)},ke=()=>{A(!1),je("success"),me(" New Lead created successfully"),J(!0)};return e.jsxs("div",{style:{padding:"10px"},children:[e.jsx("h1",{className:"text-center",children:"Followed Leads Index"}),e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:8,children:e.jsx(Te,{sx:{width:"100%",bgcolor:"background.paper"},children:e.jsxs(Be,{value:L,onChange:(a,i)=>y(i),centered:!0,children:[e.jsx(se,{label:"All Leads",value:1}),e.jsx(se,{label:"Today's Leads",value:2})]})})}),e.jsx(s,{item:!0,xs:4,display:"flex",justifyContent:"end",children:e.jsx(w,{variant:"outlined",onClick:Ce,children:"Cancel Filters"})})]}),e.jsx(w,{onClick:()=>Se(),children:"New wakeing leads"}),e.jsxs(s,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(l,{fullWidth:!0,label:"Search",placeholder:"Search by name, email, or mobile",onChange:a=>j(a.target.value),value:o})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(Me,{fullWidth:!0,children:e.jsxs(Ne,{value:S,onChange:pe,children:[e.jsx(f,{value:5,children:"5 Per Page"}),e.jsx(f,{value:10,children:"10 Per Page"}),e.jsx(f,{value:15,children:"15 Per Page"}),e.jsx(f,{value:1,children:"All Per Page"})]})})})]}),e.jsxs(s,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(s,{item:!0,xs:6,children:e.jsxs(l,{fullWidth:!0,select:!0,label:"Select State",value:D,onChange:a=>E(a.target.value),children:[e.jsx(f,{value:"",children:"All States"}),M.map((a,i)=>e.jsx(f,{value:a,children:a},i))]})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(l,{fullWidth:!0,select:!0,label:"Select City",value:N,onChange:a=>_(a.target.value),disabled:!D,children:[e.jsx(f,{value:"",children:"All Cities"}),Y.map((a,i)=>e.jsx(f,{value:a,children:a},i))]})})]}),e.jsx(Ee,{component:Fe,style:{marginTop:"20px"},children:e.jsxs(Oe,{children:[e.jsx(Ye,{children:e.jsxs(ee,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:[e.jsx(m,{children:"S.No"}),e.jsx(m,{children:"Employee Name"}),e.jsx(m,{children:"Leads Name"}),e.jsx(m,{children:"Leads Mobile"}),e.jsx(m,{children:"Leads Email"}),e.jsx(m,{children:"Leads Company"}),e.jsx(m,{children:"State"}),e.jsx(m,{children:"City"}),e.jsx(m,{children:"Reminder Date"}),e.jsx(m,{children:"Action"})]})}),e.jsx(Ae,{children:be.map((a,i)=>e.jsxs(ee,{children:[e.jsx(m,{children:i+1}),e.jsx(m,{children:a.emp_name}),e.jsx(m,{children:a.leads_name}),e.jsx(m,{children:a.leads_mobile}),e.jsx(m,{children:a.leads_email}),e.jsx(m,{children:a.leads_company}),e.jsx(m,{children:a.leads_state}),e.jsx(m,{children:a.leads_city}),e.jsx(m,{children:Q(a.reminder_date).format("YYYY-MM-DD")}),e.jsxs(m,{children:[e.jsx(w,{variant:"outlined",onClick:b=>ye(b,a),children:"Quotation"}),e.jsxs(Ue,{open:ve&&(k==null?void 0:k.follow_id)===a.follow_id,anchorEl:r,onClose:K,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[e.jsx(f,{onClick:()=>V("quotation",a.follow_id),children:"Quotation"}),e.jsx(f,{onClick:()=>V("proforma",a.follow_id),children:"Proforma"}),e.jsx(f,{onClick:()=>V("invoice",a.follow_id),children:"Invoice"})]}),e.jsx(w,{onClick:()=>fe(a.follow_id),children:"Edit"})]})]},i))})]})}),e.jsx(s,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(Ie,{spacing:2,children:e.jsx(Qe,{count:Math.ceil(d.length/S),page:h,onChange:(a,i)=>g(i),size:"small"})})}),e.jsx(le,{open:ue,autoHideDuration:3e3,onClose:X,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(ne,{onClose:X,severity:xe,sx:{width:"100%"},children:he})}),e.jsxs(U,{open:T,onClose:()=>v(!1),maxWidth:"md",children:[e.jsx(I,{children:e.jsx($e,{data:re,onClose:()=>v(!1)})}),e.jsx(R,{children:e.jsx(w,{onClick:()=>v(!1),children:"Close"})})]}),e.jsxs(U,{open:G,onClose:()=>A(!1),maxWidth:"md",children:[e.jsx(I,{children:e.jsx(ze,{data:H,onSuccess:ke})}),e.jsx(R,{children:e.jsx(w,{onClick:()=>A(!1),children:"Close"})})]}),e.jsxs(U,{open:ie,onClose:()=>B(!1),maxWidth:"md",children:[e.jsx(Re,{children:"Edit"}),e.jsx(I,{children:e.jsx(qe,{data:de,onClose:()=>B(!1)})}),e.jsx(R,{children:e.jsx(w,{onClick:()=>B(!1),children:"Close"})})]}),e.jsxs(U,{open:oe,onClose:()=>$(!1),maxWidth:"md",children:[e.jsx(I,{children:e.jsx(Ve,{data:ce,onClose:()=>$(!1)})}),e.jsx(R,{children:e.jsx(w,{onClick:()=>$(!1),children:"Close"})})]})]})};export{ts as default};
