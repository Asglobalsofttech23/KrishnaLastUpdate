import{r as a,c as m,d as p,j as e,T as L,G as c,a9 as q,F as S,I as P,ac as f,aa as l,a1 as O,a2 as U,a3 as $,a4 as Q,a5 as T,a6 as s,a7 as z,ab as J,ae as K}from"./index-BHisX-em.js";import{P as V}from"./Pagination-QMDpzdN5.js";const te=()=>{const[y,C]=a.useState([]);a.useState(!1);const[X,b]=a.useState([]),[v,u]=a.useState(!1),[F,k]=a.useState(""),[w,M]=a.useState("success");a.useState({productName:"",productId:"",specification:"",quantity:"",price:"",gst:"",cgst:"",sgst:"",totalPrice:"",totalPriceWithGST:"",fromName:"",address:"",street:"",city:"",state:"",pinCode:""});const[x,G]=a.useState(""),[i,W]=a.useState(""),[o,A]=a.useState(""),[d,n]=a.useState(1),[h,Z]=a.useState(5);a.useEffect(()=>{(async()=>{try{const r=await m.get(`${p.apiUrl}/purchase/purchases`);C(r.data)}catch(r){console.error("Error fetching purchases:",r)}})()},[]),a.useEffect(()=>{m.get(`${p.apiUrl}/product/getProductData`).then(t=>{b(t.data)}).catch(t=>{console.error("Error fetching products:",t),k("Failed to fetch products"),M("error"),u(!0)})},[]);const j=(t,r)=>{r!=="clickaway"&&u(!1)},E=t=>{G(t.target.value),n(1)},I=t=>{W(t.target.value),n(1)},N=t=>{A(t.target.value),n(1)},g=()=>y.filter(t=>{const r=t.productName.toLowerCase().includes(x.toLowerCase()),B=i?new Date(t.date).getMonth()+1===parseInt(i):!0,H=o?new Date(t.date).getFullYear()===parseInt(o):!0;return r&&B&&H}),Y=(t,r)=>{n(r)},D=Math.ceil(g().length/h),R=g().slice((d-1)*h,d*h);return e.jsxs(e.Fragment,{children:[e.jsx(L,{variant:"h1",align:"center",marginTop:"20px",gutterBottom:!0,children:"Purchase History"}),e.jsxs(c,{container:!0,spacing:2,style:{marginBottom:"20px"},children:[e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(q,{label:"Search",variant:"outlined",value:x,onChange:E,fullWidth:!0})}),e.jsx(c,{item:!0,xs:6,sm:3,children:e.jsxs(S,{fullWidth:!0,variant:"outlined",children:[e.jsx(P,{children:"Month"}),e.jsxs(f,{value:i,onChange:I,label:"Month",children:[e.jsx(l,{value:"",children:e.jsx("em",{children:"All"})}),[...Array(12).keys()].map(t=>e.jsx(l,{value:t+1,children:t+1},t+1))]})]})}),e.jsx(c,{item:!0,xs:6,sm:3,children:e.jsxs(S,{fullWidth:!0,variant:"outlined",children:[e.jsx(P,{children:"Year"}),e.jsxs(f,{value:o,onChange:N,label:"Year",children:[e.jsx(l,{value:"",children:e.jsx("em",{children:"All"})}),[2020,2021,2022,2023,2024].map(t=>e.jsx(l,{value:t,children:t},t))]})]})})]}),e.jsx(O,{component:U,style:{marginTop:"20px"},children:e.jsxs($,{children:[e.jsx(Q,{children:e.jsxs(T,{children:[e.jsx(s,{children:"Product Name"}),e.jsx(s,{children:"Specification"}),e.jsx(s,{children:"Quantity"}),e.jsx(s,{children:"Price Per Piece"}),e.jsx(s,{children:"CGST"}),e.jsx(s,{children:"SGST"}),e.jsx(s,{children:"Total GST"}),e.jsx(s,{children:"Total Price (Without GST)"}),e.jsx(s,{children:"Total Price (With GST)"}),e.jsx(s,{children:"From"}),e.jsx(s,{children:"Address"})]})}),e.jsx(z,{children:R.map(t=>e.jsxs(T,{children:[e.jsx(s,{children:t.productName}),e.jsx(s,{children:t.specification}),e.jsx(s,{children:t.quantity}),e.jsx(s,{children:t.price}),e.jsx(s,{children:t.cgst}),e.jsx(s,{children:t.sgst}),e.jsx(s,{children:(parseFloat(t.cgst)+parseFloat(t.sgst)).toFixed(2)}),e.jsx(s,{children:t.totalPrice}),e.jsx(s,{children:t.totalPriceWithGST}),e.jsx(s,{children:t.fromName}),e.jsxs(s,{children:[t.address,", ",t.street,", ",t.city,", ",t.state,", ",t.pinCode]})]},t.id))})]})}),e.jsx(V,{count:D,page:d,onChange:Y,style:{marginTop:"20px",display:"flex",justifyContent:"center"}}),e.jsx(J,{open:v,autoHideDuration:6e3,onClose:j,children:e.jsx(K,{onClose:j,severity:w,sx:{width:"100%"},children:F})})]})};export{te as default};
