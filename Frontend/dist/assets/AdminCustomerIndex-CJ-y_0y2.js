import{af as ae,r as n,c as se,d as ne,j as e,G as r,B as le,g as j,a9 as b,F as ie,ac as re,aa as i,a1 as oe,a2 as ce,a3 as de,a4 as he,a5 as F,a6 as s,a7 as ue,ag as xe,S as me,Z as je,a0 as pe,a8 as ge}from"./index-BHisX-em.js";import{h as _}from"./moment-G82_0lEo.js";import{T as fe,a as A,U as Ce}from"./UpdateFlwLeads-D-434VQN.js";import{P as Se}from"./Pagination-QMDpzdN5.js";import"./FormControlLabel-xFWTLzzh.js";const Pe=()=>{const M=ae(),[d,I]=n.useState([]),[y,D]=n.useState(null),[p,P]=n.useState(null),[g,f]=n.useState([]),[h,T]=n.useState(5),[C,S]=n.useState(1),[B,N]=n.useState([]),[O,L]=n.useState([]),[o,w]=n.useState(""),[u,k]=n.useState(""),[c,U]=n.useState("");sessionStorage.getItem("emp_id");const[x,W]=n.useState(1),[Y,m]=n.useState(!1),[z,Q]=n.useState([]);n.useEffect(()=>{se.get(`${ne.apiUrl}/customer/CustomerLeadsByAdmin`).then(t=>{const a=new Set(t.data.map(l=>l.leads_state));N([...a]),I(t.data),f(t.data)}).catch(t=>{console.log("Leads data is not fetched.",t)})},[Y]),n.useEffect(()=>{if(o){const t=new Set(d.filter(a=>a.leads_state===o).map(a=>a.leads_city));L([...t])}else L([])},[o]),n.useEffect(()=>{const t=_().format("YYYY-MM-DD"),a=d.filter(l=>{const K=c===""||l.leads_name.toLowerCase().includes(c.toLowerCase())||l.leads_name.toUpperCase().includes(c.toUpperCase)||l.leads_email.toLowerCase().includes(c.toLowerCase())||l.leads_email.toUpperCase().includes(c.toUpperCase())||l.leads_mobile.includes(c),X=o===""||l.leads_state===o,ee=u===""||l.leads_city===u,te=x===1||x===2&&_(l.created_at).format("YYYY-MM-DD")===t;return K&&X&&ee&&te});f(a)},[c,o,u,x,d]);const R=t=>{const a=parseInt(t.target.value,10);a==1?(T(d.length),S(1)):(T(a),S(1))},$=(C-1)*h,G=C*h,V=g?g.slice($,G):[],q=()=>{w(""),k(""),U(""),f(d)},H=t=>{const a=d.find(l=>l.follow_id===t);a&&(Q(a),m(!0))},Z=(t,a)=>{D(t.currentTarget),P(a)},E=()=>{D(null),P(null)},v=(t,a)=>{E(),M(`/${t}/${a}`)},J=!!y;return e.jsxs("div",{style:{padding:"10px"},children:[e.jsx("h1",{className:"text-center",children:"Customer Index"}),e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:8,children:e.jsx(le,{sx:{width:"100%",bgcolor:"background.paper"},children:e.jsxs(fe,{value:x,onChange:(t,a)=>W(a),centered:!0,children:[e.jsx(A,{label:"All Leads",value:1}),e.jsx(A,{label:"Today's Leads",value:2})]})})}),e.jsx(r,{item:!0,xs:4,display:"flex",justifyContent:"end",children:e.jsx(j,{variant:"outlined",onClick:q,children:"Cancel Filters"})})]}),e.jsxs(r,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(r,{item:!0,xs:6,children:e.jsx(b,{fullWidth:!0,label:"Search",placeholder:"Search by name, email, or mobile",onChange:t=>U(t.target.value),value:c})}),e.jsx(r,{item:!0,xs:6,children:e.jsx(ie,{fullWidth:!0,children:e.jsxs(re,{value:h,onChange:R,children:[e.jsx(i,{value:5,children:"5 Per Page"}),e.jsx(i,{value:10,children:"10 Per Page"}),e.jsx(i,{value:15,children:"15 Per Page"}),e.jsx(i,{value:1,children:"All Per Page"})]})})})]}),e.jsxs(r,{container:!0,spacing:3,style:{marginTop:"20px"},children:[e.jsx(r,{item:!0,xs:6,children:e.jsxs(b,{fullWidth:!0,select:!0,label:"Select State",value:o,onChange:t=>w(t.target.value),children:[e.jsx(i,{value:"",children:"All States"}),B.map((t,a)=>e.jsx(i,{value:t,children:t},a))]})}),e.jsx(r,{item:!0,xs:6,children:e.jsxs(b,{fullWidth:!0,select:!0,label:"Select City",value:u,onChange:t=>k(t.target.value),disabled:!o,children:[e.jsx(i,{value:"",children:"All Cities"}),O.map((t,a)=>e.jsx(i,{value:t,children:t},a))]})})]}),e.jsx(oe,{component:ce,style:{marginTop:"20px"},children:e.jsxs(de,{children:[e.jsx(he,{children:e.jsxs(F,{style:{fontWeight:"bold",backgroundColor:"#FFF9C4"},children:[e.jsx(s,{children:"S.No"}),e.jsx(s,{children:"Employee Name"}),e.jsx(s,{children:"Leads Name"}),e.jsx(s,{children:"Leads Mobile"}),e.jsx(s,{children:"Leads Email"}),e.jsx(s,{children:"Leads Company"}),e.jsx(s,{children:"State"}),e.jsx(s,{children:"City"}),e.jsx(s,{children:"Reminder Date"}),e.jsx(s,{children:"Action"})]})}),e.jsx(ue,{children:V.map((t,a)=>e.jsxs(F,{children:[e.jsx(s,{children:a+1}),e.jsx(s,{children:t.emp_name}),e.jsx(s,{children:t.leads_name}),e.jsx(s,{children:t.leads_mobile}),e.jsx(s,{children:t.leads_email}),e.jsx(s,{children:t.leads_company}),e.jsx(s,{children:t.leads_state}),e.jsx(s,{children:t.leads_city}),e.jsx(s,{children:_(t.reminder_date).format("YYYY-MM-DD")}),e.jsxs(s,{children:[e.jsx(j,{variant:"outlined",onClick:l=>Z(l,t),children:"Quotation"}),e.jsxs(xe,{open:J&&(p==null?void 0:p.follow_id)===t.follow_id,anchorEl:y,onClose:E,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[e.jsx(i,{onClick:()=>v("quotation",t.follow_id),children:"Quotation"}),e.jsx(i,{onClick:()=>v("proforma",t.follow_id),children:"Proforma"}),e.jsx(i,{onClick:()=>v("invoice",t.follow_id),children:"Invoice"})]}),e.jsx(j,{onClick:()=>H(t.follow_id),children:"Edit"})]})]},a))})]})}),e.jsx(r,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(me,{spacing:2,children:e.jsx(Se,{count:Math.ceil(g.length/h),page:C,onChange:(t,a)=>S(a),size:"small"})})}),e.jsxs(je,{open:Y,onClose:()=>m(!1),maxWidth:"md",children:[e.jsx(pe,{children:e.jsx(Ce,{data:z,onClose:()=>m(!1)})}),e.jsx(ge,{children:e.jsx(j,{onClick:()=>m(!1),children:"Close"})})]})]})};export{Pe as default};
